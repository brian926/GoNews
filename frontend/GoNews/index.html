<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Top News with Language Selector</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .article {
      border-bottom: 1px solid #ccc;
      margin-bottom: 10px;
      padding-bottom: 10px;
    }
    .article h2 {
      margin: 0 0 5px;
    }
    .article p {
      margin: 5px 0;
    }
    .article a {
      color: blue;
      text-decoration: none;
    }
    .controls {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="app">
    <h1>Top News</h1>
    <div class="controls">
      <label for="language">Select Language:</label>
      <select id="language" v-model="selectedLanguage" @change="fetchNews">
        <option v-for="lang in languages" :value="lang.value" :key="lang.value">{{ lang.label }}</option>
      </select>
    </div>
    <div v-if="loading">Loading news...</div>
    <div v-if="error">{{ error }}</div>
    <div v-if="articles.length > 0">
      <div v-for="article in articles" :key="article.url" class="article">
        <h2><a :href="article.url" target="_blank">{{ article.title }}</a></h2>
        <p>{{ article.description || "No description available" }}</p>
      </div>
    </div>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          articles: [],
          loading: false,
          error: null,
          selectedLanguage: "en", // Default language
          languages: [
            { value: "en", label: "English" },
            { value: "es", label: "Spanish" },
            { value: "fr", label: "French" },
            { value: "de", label: "German" },
            { value: "pt", label: "Portuguese" },
          ],
        };
      },
      methods: {
        async fetchNews() {
          this.loading = true;
          this.error = null;
          try {
            const response = await fetch(`http://localhost:5432/news?lang=${this.selectedLanguage}`);
            if (!response.ok) {
              throw new Error("Failed to fetch news.");
            }
            this.articles = await response.json();
          } catch (error) {
            this.error = error.message;
          } finally {
            this.loading = false;
          }
        },
      },
      mounted() {
        this.fetchNews();
      },
    }).mount("#app");
  </script>
</body>
</html>
